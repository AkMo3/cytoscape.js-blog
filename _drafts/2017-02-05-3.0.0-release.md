---
layout: post
title: Announcing Cytoscape.js v3
subtitle: New features, breaking changes, and migration from v2 to v3
tags:
- news
---

Cytoscape.js 3 has been released!
[As promised]({% post_url 2016-06-06-2.7-3.0-and-beyond %}), the majority of the changes are housekeeping-related, with a few significant (read: breaking) API changes to help with usability and future-proofing as JS evolves.

# Overview
- Functions with `function(i, ele)` signature are now `function(ele, i)` [#1531](https://github.com/cytoscape/cytoscape.js/issues/1531)
- `cy.layout()` and `eles.layout()` now return the layout, rather than chaining the calling object [#1533](https://github.com/cytoscape/cytoscape.js/issues/1533)
- `this` is no longer modified to be the element of interest for many callback functions [#1535](https://github.com/cytoscape/cytoscape.js/issues/1535)

# API Changes and Migration

- Functions with a `function(i, ele)` signature are now `function(ele, i)`
  - [Issue discussion here](https://github.com/cytoscape/cytoscape.js/issues/1531)
  - Affects: `eles.each()`, `eles.bfs()`, `eles.dfs()`, `eles.filter()`, `eles.positions()`, `eles.layoutPositions()`
  - It's now simpler to use ES6 syntax for operations on elements! Example:

  ```javascript
  // v2
  cy.elements().each(function(i, ele){
    console.log( ele.id() + ' is ' + ( ele.selected() ? 'selected' : 'not selected' ) );
  });
  // new v3 syntax; we can ignore the index i
  cy.elements().each(ele => console.log( ele.id() + ' is ' ( ele.selected() ? 'selected' : 'not selected' ) ) );
  ```

- `cy.layout()` and `eles.layout()` now return the layout (rather than chaining the calling object)
  - [Issue discussion here](https://github.com/cytoscape/cytoscape.js/issues/1533)
  - Any code which previously ran a layout by calling `eles.layout( opts )` or `cy.layout( opts )` should be changed to `eles.layout( opts ).run()` or `cy.layout( opts ).run()`

- `this` is no longer modified for many callbacks
  - [Issue discussion here](https://github.com/cytoscape/cytoscape.js/issues/1535)
  - Affects: 
    - `eles.each()`
    - `eles.filter()`
    - `eles.positions()`
    - `eles.layoutPositions()`
    - `eles.bfs()`
    - `eles.dfs()`
    - `eles.dijkstra()`
    - `eles.aStar()`
    - `eles.bellmanFord()`
    - `eles.kruskal()`
    - `eles.floydWarshall()`
    - `eles.pageRank()`
    - `eles.closenessCentrality()` and `eles.closenessCentralityNormalized()`
    - `eles.betweennessCentrality()` and `eles.betweennessCentralityNormalized()`
    - `eles.degreeCentrality()` and `eles.degreeCentralityNormalized()`
    - concentric and cose layouts (already deprecated)
  - Avoiding changing `this` in the bodies of functions (keeps the `this` context from outside the function) makes
  [working with arrow functions nicer](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions#No_bindingof_this)
  - **TODO: add code example for this one since it's complex**